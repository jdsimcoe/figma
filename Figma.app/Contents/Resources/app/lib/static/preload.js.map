{"version":3,"sources":["preload.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;IAMO;;;;IAAa;;AAEpB,IAAM,iBAAiB,eAAK,IAAL,CAAU,SAAV,EAAqB,QAArB,EAA+B,kBAA/B,CAAjB;;AAEN,wBAAwB,UAAC,KAAD,EAAQ,GAAR,EAAgB;AACpC,gBAAY,IAAZ,CAAiB,cAAjB,EAAiC,KAAjC,EAAwC,GAAxC,EADoC;CAAhB,CAAxB;;AAIA,SAAS,gBAAT,CAA0B,kBAA1B,EAA8C,iBAAS;;;AAGnD,WAAO,gBAAP,CAAwB,aAAxB,EAAuC,iBAAS;AAC5C,cAAM,cAAN,GAD4C;AAE5C,YAAM,gBAAgB,MAAM,UAAN,CAFsB;AAG5C,YAAM,aAAa,cAAc,IAAd,CAHyB;;AAK5C,YAAI,CAAC,UAAD,EAAa;AACb,wBAAY,IAAZ,CAAiB,mBAAjB,EAAsC,YAAM;AACxC,8BAAc,MAAM,MAAN,CAAd,CADwC;AAExC,4BAAY,IAAZ,CAAiB,yBAAjB,EAFwC;aAAN,CAAtC,CADa;SAAjB;;AAOA,oBAAY,IAAZ,CAAiB,mBAAjB,EAAsC,UAAtC,EAZ4C;KAAT,EAapC,KAbH,EAHmD;;AAkBnD,oBAlBmD;CAAT,CAA9C;;AAqBA,YAAY,EAAZ,CAAe,QAAf,EAAyB,UAAC,KAAD,EAAQ,OAAR,EAAoB;AACzC,QAAM,UAAU,KAAK,KAAL,CAAW,OAAX,CAAV,CADmC;AAEzC,YAAQ,GAAR,CAAY,iBAAZ,EAA+B,OAA/B,EAFyC;CAApB,CAAzB;;AAKA,YAAY,EAAZ,CAAe,aAAf,EAA8B,UAAC,KAAD,EAAQ,OAAR,EAAoB;AAC9C,aAAS,aAAT,CAAuB,OAAvB,EAD8C;CAApB,CAA9B;;;;;;AAQA,SAAS,uBAAT,CAAiC,QAAjC,EAA2C;;AAEvC,QAAM,YAAY,OAAO,YAAP,CAFqB;AAGvC,QAAM,YAAY,SAAZ,SAAY,CAAC,KAAD,EAAQ,GAAR,EAAgB;AAC9B,iBAAS,KAAT,EAAgB,GAAhB,EAD8B;AAE9B,eAAO,IAAI,SAAJ,CAAc,KAAd,EAAqB,GAArB,CAAP,CAF8B;KAAhB,CAHqB;AAOvC,cAAU,iBAAV,GAA8B,UAAU,iBAAV,CAA4B,IAA5B,CAAiC,SAAjC,CAA9B,CAPuC;AAQvC,WAAO,cAAP,CAAsB,SAAtB,EAAiC,YAAjC,EAA+C;AAC3C,aAAK,eAAM;AACP,mBAAO,UAAU,UAAV,CADA;SAAN;KADT,EARuC;;AAcvC,WAAO,YAAP,GAAsB,SAAtB,CAduC;CAA3C;;AAiBA,SAAS,aAAT,CAAuB,OAAvB,EAAgC;AAC5B,QAAM,aAAa,IAAI,UAAJ,CAAe,OAAf,CAAb,CADsB;AAE5B,YAAQ,aAAR,CAAsB,UAAtB,EAF4B;CAAhC;;AAKA,SAAS,aAAT,GAAyB;AACrB,QAAM,eAAe,aAAG,UAAH,CAAc,cAAd,CAAf,CADe;AAErB,QAAI,CAAC,YAAD,EAAe;AACf,eADe;KAAnB;AAGA,YAAQ,cAAR,EALqB;CAAzB","file":"preload.js","sourcesContent":["/**\n Preload file that will be executed in the renderer process\n */\nimport electron from 'electron';\nimport path from 'path';\nimport fs from 'fs';\nconst {ipcRenderer, webFrame} = electron;\n\nconst INJECT_JS_PATH = path.join(__dirname, '../../', 'inject/inject.js');\n\nsetNotificationCallback((title, opt) => {\n    ipcRenderer.send('notification', title, opt);\n});\n\ndocument.addEventListener('DOMContentLoaded', event => {\n    // do things\n\n    window.addEventListener('contextmenu', event => {\n        event.preventDefault();\n        const targetElement = event.srcElement;\n        const targetHref = targetElement.href;\n\n        if (!targetHref) {\n            ipcRenderer.once('contextMenuClosed', () => {\n                clickSelector(event.target);\n                ipcRenderer.send('cancelNewWindowOverride');\n            });\n        }\n\n        ipcRenderer.send('contextMenuOpened', targetHref);\n    }, false);\n\n    injectScripts();\n});\n\nipcRenderer.on('params', (event, message) => {\n    const appArgs = JSON.parse(message);\n    console.log('nativefier.json', appArgs);\n});\n\nipcRenderer.on('change-zoom', (event, message) => {\n    webFrame.setZoomFactor(message);\n});\n\n/**\n * Patches window.Notification to set a callback on a new Notification\n * @param callback\n */\nfunction setNotificationCallback(callback) {\n\n    const OldNotify = window.Notification;\n    const newNotify = (title, opt) => {\n        callback(title, opt);\n        return new OldNotify(title, opt);\n    };\n    newNotify.requestPermission = OldNotify.requestPermission.bind(OldNotify);\n    Object.defineProperty(newNotify, 'permission', {\n        get: () => {\n            return OldNotify.permission;\n        }\n    });\n\n    window.Notification = newNotify;\n}\n\nfunction clickSelector(element) {\n    const mouseEvent = new MouseEvent('click');\n    element.dispatchEvent(mouseEvent);\n}\n\nfunction injectScripts() {\n    const needToInject = fs.existsSync(INJECT_JS_PATH);\n    if (!needToInject) {\n        return;\n    }\n    require(INJECT_JS_PATH);\n}\n"],"sourceRoot":"/source/"}